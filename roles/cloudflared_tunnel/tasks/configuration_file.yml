---
- name: Ensure the config file target directory exists
  file:
    state: directory
    path: "{{ cloudflared_service_config_file | dirname }}"
  become: true

- name: Ensure config file is templated
  template:
    src: config.yml.j2
    dest: "{{ cloudflared_service_config_file }}"
  become: true
  notify:
  - restart cloudflared service
