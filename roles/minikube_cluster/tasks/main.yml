---
- name: Ensure that container runtime is installed and enabled in minikube
  include_tasks: container_driver/podman.yml

- name: Ensure that a container runtime is installed and set
  include_tasks: container_runtime/crio.yml

- name: Check if Minikube is already started
  ansible.builtin.command:
    cmd: minikube status
  register: minikube_status_result
  changed_when: false
  failed_when: false

- debug:
    var: minikube_status_result

- name: Start Minikube cluster
  shell: minikube start --cpus=4 --memory=6g --addons=ingress
  register: start_minikube_status
  when: "'host: Running' not in minikube_status_result.stdout"