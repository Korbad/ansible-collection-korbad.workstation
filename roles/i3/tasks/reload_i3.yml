- name: Fetch active user environ before reloading i3
  include_role:
    name: korbad.tools.get_active_user_environ

- name: Get i3 socket path
  shell: i3 --get-socketpath
  register: i3_socket_path
  environment:
    DISPLAY: "{{ active_user_environ_dict.DISPLAY }}"

- name: Reload i3
  command: i3-msg reload
  environment:
    DISPLAY: "{{ active_user_environ_dict.DISPLAY }}"
    I3SOCK: "{{ i3_socket_path.stdout }}"