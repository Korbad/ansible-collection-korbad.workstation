---
- name: Ensure i3 Window Manager is installed
  community.general.pacman:
    name: i3
  become: true

- name: Ensure that the i3 config dir exists
  file:
    path: "{{ ansible_env.HOME }}/.config/i3"
    state: directory

- name: Set i3config default so it doesn't need to be generated by the i3 config wizard
  template:
    src: i3config.j2
    dest: "{{ ansible_env.HOME }}/.config/i3/config"
  notify: reload i3

#- name: Set i3 to require click to focus
#  lineinfile:
#    path: "{{ ansible_env.HOME }}/.config/i3/config"
#    line: 'focus_follows_mouse no'
##  notify: restart i3
#
#- name: Set $mod to Windows key
#  lineinfile:
#    path: "{{ ansible_env.HOME }}/.config/i3/config"
#    line: 'set $mod Mod4'
##  notify: restart i3

- name: Ensure .xinitrc exists and has correct configuration
  template:
    src: xinitrc.j2
    dest: "{{ ansible_env.HOME }}/.xinitrc"
    owner: "{{ ansible_env.USER }}"
    mode: '0744' # Ensures the file is executable