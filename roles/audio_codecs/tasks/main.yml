---
- name: Ensure the alsa-utils audio codecs are installed
  community.general.pacman:
    name: alsa-utils
  become: true

- name: Ensure the pulse-audio codecs and the pulseaudio-alsa interface is installed
  community.general.pacman:
    name:
      - pulseaudio
      - pulseaudio-alsa
  become: true

- name: Ensure the pavucontrol (Pulse Audio TUI) is installed
  community.general.pacman:
    name: pavucontrol
  become: true

- name: Ensure pulseaudio config directory exists
  ansible.builtin.file:
    path: "{{ ansible_env.HOME }}/.config/pulse"
    state: directory

- name: Change default sample rate in PulseAudio user configuration
  ansible.builtin.lineinfile:
    path: "{{ ansible_env.HOME }}/.config/pulse/daemon.conf"
    regexp: '^;? default-sample-rate ='
    line: 'default-sample-rate = 48000'
    create: yes
  notify: restart pulseaudio
...
