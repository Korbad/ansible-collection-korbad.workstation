---
- name: Ensure Nftables packages are in their desired state
  ansible.builtin.package:
    name: nftables
    state: "{{ nftables_package_state }}"
  register: pkg_install_result
  until: pkg_install_result is success
  become: true

- name: Manage nftables service
  ansible.builtin.service:
    state: "{{ nftables_service_state }}"
    name: nftables
    enabled: "{{ nftables_service_enabled }}"
  become: true
